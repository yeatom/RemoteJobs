<view class="resume-view-container">
  
  <ui-scroll-view scrollY="{{true}}" enableFlex="{{true}}" custom-class="tools-scroll">
    <view class="header">
      <text class="title">{{ui.title}}</text>
      <text class="subtitle">{{ui.subtitle}}</text>
    </view>

      <view class="tools-grid">
        <!-- 1. ä¸ç”¨æ”¹ -->
      <view class="tool-card" bindtap="onUploadScreenshot">
        <view class="icon-box blue">
          <text class="tool-emoji">ğŸ“¸</text>
        </view>
        <view class="tool-info">
          <text class="tool-name">{{ui.toolScreenshotTitle}}</text>
          <text class="tool-desc">{{ui.toolScreenshotDesc}}</text>
        </view>
        <text class="ui-arrow">â¯</text>
      </view>

      <!-- 2. æ–‡å­—ç”Ÿæˆç®€å† -->
      <view class="tool-card" bindtap="onTextResumeTap">
        <view class="icon-box blue">
          <text class="tool-emoji">âœ¨</text>
        </view>
        <view class="tool-info">
          <text class="tool-name">{{ui.toolTextTitle}}</text>
          <text class="tool-desc">{{ui.toolTextDesc}}</text>
        </view>
        <text class="ui-arrow">â¯</text>
      </view>

      <!-- 3. ä¸ç”¨æ”¹ -->
      <view class="tool-card" bindtap="onRefineOldResume">
        <view class="icon-box blue">
          <text class="tool-emoji">ğŸ“„</text>
        </view>
        <view class="tool-info">
          <text class="tool-name">{{ui.toolRefineTitle}}</text>
          <text class="tool-desc">{{ui.toolRefineDesc}}</text>
        </view>
        <text class="ui-arrow">â¯</text>
      </view>
    </view>
  </ui-scroll-view>

  <!-- Unified Drawer for Text/Screenshot Resume Generation -->
  <ui-drawer 
    id="jdDrawer" 
    show="{{showJdDrawer}}" 
    title="{{drawerTitle}}" 
    confirmText="{{ui.confirmGenerate}}"
    confirmActive="{{canSubmit}}"
    useScroll="{{false}}"
    bind:close="closeJdDrawer"
    bind:confirm="onOptimizeKeywords"
  >
    <view class="drawer-body">
      <view class="form-item">
        <text class="label">{{ui.jobTitle}}</text>
        <input 
          class="input" 
          placeholder="{{ui.jobTitlePlaceholder}}" 
          placeholder-class="placeholder"
          value="{{targetJob.title}}" 
          bindinput="onJdFieldChange" 
          data-field="title"
          cursor-color="{{ui.cursorColor}}"
          show-confirm-bar="{{false}}"
        />
      </view>

      <view class="form-item">
        <text class="label">{{ui.company}}</text>
        <input 
          class="input" 
          placeholder="{{ui.companyPlaceholder}}" 
          placeholder-class="placeholder"
          value="{{targetJob.company}}" 
          bindinput="onJdFieldChange" 
          data-field="company"
          cursor-color="{{ui.cursorColor}}"
          show-confirm-bar="{{false}}"
        />
      </view>

      <view class="form-item">
        <text class="label">{{ui.experience}}</text>
        <input 
          class="input" 
          placeholder="{{ui.experiencePlaceholder}}" 
          placeholder-class="placeholder"
          value="{{targetJob.experience}}" 
          bindinput="onJdFieldChange" 
          data-field="experience"
          cursor-color="{{ui.cursorColor}}"
          show-confirm-bar="{{false}}"
        />
      </view>
      
      <view class="form-item">
        <text class="label">{{ui.jobDescription}}</text>
        <textarea 
          class="textarea" 
          placeholder="{{ui.jdPlaceholder}}" 
          placeholder-class="placeholder"
          style="min-height: 200rpx;"
          value="{{targetJob.content}}" 
          bindinput="onJdFieldChange" 
          data-field="content"
          maxlength="5000"
          cursor-color="{{ui.cursorColor}}"
          show-confirm-bar="{{false}}"
        ></textarea>
      </view>
    </view>
  </ui-drawer>

  <!-- Resume Refine Drawer -->
  <ui-drawer 
    id="refineDrawer" 
    show="{{showRefineDrawer}}" 
    title="{{ui.toolRefineTitle}}" 
    useScroll="{{false}}"
    showConfirm="{{false}}"
    bind:close="closeRefineDrawer"
  >
    <view class="drawer-body">
      <view class="upload-options">
         <view class="upload-btn" bindtap="onSelectFromChat">
            <view class="icon-box green">
              <text class="tool-emoji">ğŸ’¬</text>
            </view>
            <text class="btn-text">Select from Chat</text>
            <text class="ui-arrow">â¯</text>
         </view>
         <view class="upload-btn" bindtap="onSelectFromLocal">
            <view class="icon-box purple">
              <text class="tool-emoji">ğŸ“</text>
            </view>
            <text class="btn-text">Upload from Local</text>
             <text class="ui-arrow">â¯</text>
         </view>
      </view>
    </view>
  </ui-drawer>

  <!-- Login Wall & Splash Loader -->
  
  <!-- Custom File Preview Modal -->
  <view class="preview-mask {{showPreviewModal ? 'visible' : ''}}">
    <view class="preview-container">
        <view class="preview-header">
            <text class="preview-title">ç¡®è®¤ä¸Šä¼ </text>
        </view>
        
        <view class="preview-content">
            <!-- Image Preview -->
            <image 
                wx:if="{{previewType === 'image'}}" 
                src="{{previewPath}}" 
                mode="aspectFit" 
                class="file-preview-img"
            />
            
            <!-- PDF Preview (Icon) -->
            <view wx:else class="file-preview-pdf" bindtap="openPdfPreview">
                <view class="pdf-icon">ğŸ“„</view>
                <text class="pdf-name">{{previewName}}</text>
                <text class="pdf-tip">ç‚¹å‡»é¢„è§ˆæ–‡ä»¶å†…å®¹</text>
            </view>

            <view class="quota-warning">
                <text class="warning-icon">âš ï¸</text>
                <text class="warning-text">ä¸Šä¼ å¹¶å°†æ¶ˆè€— 1 æ¬¡ç”Ÿæˆé¢åº¦</text>
            </view>
        </view>

        <view class="preview-footer">
            <button class="btn-cancel" bindtap="onCancelPreview">å–æ¶ˆ</button>
            <button class="btn-confirm" bindtap="onConfirmPreview">ç¡®è®¤ä¸Šä¼ </button>
        </view>
    </view>
  </view>
</view>
