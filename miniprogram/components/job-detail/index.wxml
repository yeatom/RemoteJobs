<!--miniprogram/components/job-detail/index.wxml-->
<view 
  wx:if="{{show}}"
  class="detail-drawer detail-drawer-open {{isSwiping ? 'detail-drawer-swiping' : ''}}"
  style="transform: translate3d({{drawerTranslateX}}px, 0, 0);"
  animation="{{animationData}}"
  bindtouchstart="onTouchStart"
  catchtouchmove="onTouchMove"
  bindtouchend="onTouchEnd"
>
  <detail-header bind:close="onClose" />
  <scroll-view     
  class="detail-content" 
  scroll-y="{{!isSwiping}}"
  enhanced="true" 
  show-scrollbar="{{false}}"
  upper-threshold="0"
  bounces="{{false}}"
  bindscroll="onScrollViewScroll"
  >
    <block wx:if="{{job}}">
      <view class="detail-body">
        <view class="detail-title-row">
          <text class="detail-title">{{job.title}}</text>
          <view class="collect-button" bindtap="toggleSave">
            <text class="collect-icon {{saved ? 'collect-icon-active' : ''}}">{{saved ? '★' : '☆'}}</text>
          </view>
        </view>
        <view class="detail-meta" wx:if="{{(isAIEnglish && job.source_name) || (!isAIEnglish && job.team && job.team !== '未知公司') || job.salary}}">
          <text wx:if="{{isAIEnglish && job.source_name}}" class="detail-meta-item">From {{job.source_name}}</text>
          <text wx:if="{{!isAIEnglish && job.team && job.team !== '未知公司'}}" class="detail-meta-item">{{job.team}}</text>
          <text wx:if="{{((isAIEnglish && job.source_name) || (!isAIEnglish && job.team && job.team !== '未知公司')) && job.salary}}" class="detail-meta-dot">·</text>
          <text wx:if="{{job.salary}}" class="detail-meta-item">{{job.salary}}</text>
        </view>
        <view class="detail-tags" wx:if="{{job.displayTags && job.displayTags.length > 0}}">
          <view class="detail-tag" wx:for="{{job.displayTags}}" wx:key="*this">
            <text class="detail-tag-text">{{item}}</text>
          </view>
        </view>
        <view class="detail-description" wx:if="{{job.richDescription}}">
          <rich-text class="detail-description-rich" nodes="{{job.richDescription}}"></rich-text>
        </view>
        <view class="detail-link" wx:if="{{job.source_url}}">
          <button class="link-button" bindtap="onCopyLink">复制链接</button>
        </view>
      </view>
    </block>
    <block wx:elif="{{loading}}">
      <view class="loading">加载中...</view>
    </block>
    <block wx:else>
      <view class="error">加载失败</view>
    </block>
  </scroll-view>
</view>
